filepaths = ["./reb0p1/","./reb0p33/","./reb1p0/","./rebNO/"]
filenames = ["HLTPhysics_PCA_080724_chi2.csv","HLTPhysics_PCA_080724_reco_integs.csv","HLTPhysics_PCA_080724_runs_and_sse_scores.csv"]
hists = ["L1T//Run summary/L1TStage2CaloLayer1/ecalOccupancy","L1T//Run summary/L1TStage2CaloLayer1/hcalOccupancy","L1T//Run summary/L1TStage2uGMT/ugmtMuonPt","L1T//Run summary/L1TStage2uGMT/ugmtMuonEta","L1T//Run summary/L1TStage2uGMT/ugmtMuonPhi","L1T//Run summary/L1TStage2uGMT/ugmtMuonPhivsEta","L1T//Run summary/L1TStage2CaloLayer2/Central-Jets/CenJetsOcc","L1T//Run summary/L1TStage2CaloLayer2/Central-Jets/CenJetsRank","L1T//Run summary/L1TStage2CaloLayer2/Forward-Jets/ForJetsOcc","L1T//Run summary/L1TStage2CaloLayer2/Forward-Jets/ForJetsRank","L1T//Run summary/L1TStage2CaloLayer2/Isolated-EG/IsoEGsOcc","L1T//Run summary/L1TStage2CaloLayer2/Isolated-EG/IsoEGsRank","L1T//Run summary/L1TStage2CaloLayer2/NonIsolated-EG/NonIsoEGsOcc","L1T//Run summary/L1TStage2CaloLayer2/NonIsolated-EG/NonIsoEGsRank","L1T//Run summary/L1TStage2CaloLayer2/Isolated-Tau/IsoTausOcc","L1T//Run summary/L1TStage2CaloLayer2/Isolated-Tau/IsoTausRank","L1T//Run summary/L1TStage2CaloLayer2/NonIsolated-Tau/TausOcc","L1T//Run summary/L1TStage2CaloLayer2/NonIsolated-Tau/TausRank","L1T//Run summary/L1TStage2CaloLayer2/Energy-Sums/ETTRank","L1T//Run summary/L1TStage2CaloLayer2/Energy-Sums/ETTEMRank","L1T//Run summary/L1TStage2CaloLayer2/Energy-Sums/HTTRank","L1T//Run summary/L1TStage2CaloLayer2/Energy-Sums/METRank","L1T//Run summary/L1TStage2CaloLayer2/Energy-Sums/METPhi","L1T//Run summary/L1TStage2CaloLayer2/Energy-Sums/METHFRank","L1T//Run summary/L1TStage2CaloLayer2/Energy-Sums/METHFPhi","L1T//Run summary/L1TStage2CaloLayer2/Energy-Sums/MHTRank","L1T//Run summary/L1TStage2CaloLayer2/Energy-Sums/MHTPhi","L1T//Run summary/L1TStage2CaloLayer2/Energy-Sums/MHTHFRank","L1T//Run summary/L1TStage2CaloLayer2/Energy-Sums/MHTHFPhi","L1T//Run summary/L1TStage2BMTF/bmtf_hwPt","L1T//Run summary/L1TStage2uGMT/BMTFInput/ugmtBMTFhwEta","L1T//Run summary/L1TStage2uGMT/BMTFInput/ugmtBMTFglbhwPhi","L1T//Run summary/L1TStage2uGMT/OMTFInput/ugmtOMTFhwPt","L1T//Run summary/L1TStage2uGMT/OMTFInput/ugmtOMTFhwEta","L1T//Run summary/L1TStage2uGMT/OMTFInput/ugmtOMTFglbhwPhiPos","L1T//Run summary/L1TStage2uGMT/OMTFInput/ugmtOMTFglbhwPhiNeg","L1T//Run summary/L1TStage2uGMT/ugmtMuonPhiEmtf","L1T//Run summary/L1TStage2EMTF/cscLCTOccupancy","L1T//Run summary/L1TObjects/L1TMuon/timing/First_bunch/muons_eta_phi_bx_firstbunch_0","L1T//Run summary/L1TObjects/L1TMuon/timing/Last_bunch/muons_eta_phi_bx_lastbunch_0","L1T//Run summary/L1TObjects/L1TTau/timing/First_bunch/tau_eta_phi_bx_firstbunch_0","L1T//Run summary/L1TObjects/L1TTau/timing/Last_bunch/tau_eta_phi_bx_lastbunch_0","L1T//Run summary/L1TObjects/L1TJet/timing/First_bunch/jet_eta_phi_bx_firstbunch_0","L1T//Run summary/L1TObjects/L1TJet/timing/Last_bunch/jet_eta_phi_bx_lastbunch_0","L1T//Run summary/L1TObjects/L1TEGamma/timing/First_bunch/ptmin_10p0_gev/egamma_eta_phi_bx_firstbunch_0","L1T//Run summary/L1TObjects/L1TEGamma/timing/Last_bunch/ptmin_10p0_gev/egamma_eta_phi_bx_lastbunch_0","L1T//Run summary/L1TObjects/L1TEGamma/timing/First_bunch/ptmin_20p0_gev/egamma_eta_phi_bx_firstbunch_0","L1T//Run summary/L1TObjects/L1TEGamma/timing/Last_bunch/ptmin_20p0_gev/egamma_eta_phi_bx_lastbunch_0","L1T//Run summary/L1TObjects/L1TEGamma/timing/First_bunch/ptmin_30p0_gev/egamma_eta_phi_bx_firstbunch_0","L1T//Run summary/L1TObjects/L1TEGamma/timing/Last_bunch/ptmin_30p0_gev/egamma_eta_phi_bx_lastbunch_0","L1T//Run summary/L1TObjects/L1TEGamma/timing/First_bunch/ptmin_10p0_gev/egamma_iso_bx_ieta_firstbunch_ptmin10p0","L1T//Run summary/L1TObjects/L1TEGamma/timing/First_bunch/ptmin_10p0_gev/egamma_noniso_bx_ieta_firstbunch_ptmin10p0","L1T//Run summary/L1TObjects/L1TEGamma/timing/Last_bunch/ptmin_10p0_gev/egamma_iso_bx_ieta_lastbunch_ptmin10p0","L1T//Run summary/L1TObjects/L1TEGamma/timing/Last_bunch/ptmin_10p0_gev/egamma_noniso_bx_ieta_lastbunch_ptmin10p0","L1T//Run summary/L1TObjects/L1TEGamma/timing/First_bunch/ptmin_20p0_gev/egamma_iso_bx_ieta_firstbunch_ptmin20p0","L1T//Run summary/L1TObjects/L1TEGamma/timing/First_bunch/ptmin_20p0_gev/egamma_noniso_bx_ieta_firstbunch_ptmin20p0","L1T//Run summary/L1TObjects/L1TEGamma/timing/Last_bunch/ptmin_20p0_gev/egamma_iso_bx_ieta_lastbunch_ptmin20p0","L1T//Run summary/L1TObjects/L1TEGamma/timing/Last_bunch/ptmin_20p0_gev/egamma_noniso_bx_ieta_lastbunch_ptmin20p0","L1T//Run summary/L1TObjects/L1TEGamma/timing/First_bunch/ptmin_30p0_gev/egamma_iso_bx_ieta_firstbunch_ptmin30p0","L1T//Run summary/L1TObjects/L1TEGamma/timing/First_bunch/ptmin_30p0_gev/egamma_noniso_bx_ieta_firstbunch_ptmin30p0","L1T//Run summary/L1TObjects/L1TEGamma/timing/Last_bunch/ptmin_30p0_gev/egamma_iso_bx_ieta_lastbunch_ptmin30p0","L1T//Run summary/L1TObjects/L1TEGamma/timing/Last_bunch/ptmin_30p0_gev/egamma_noniso_bx_ieta_lastbunch_ptmin30p0"]
enders = ["_chi2_tol0","_maxpull_tol0","_chi2_tol1","_maxpull_tol1","_scoreXnBins_PCA_080724","_score_PCA_080724","_integral_x","_reco_PCA_080724_size"]

import pandas as pd

def print_all_columns(df, name):
    print(f"\nHeaders of {name}:")
    mystring = df.head(0).to_string()
    with pd.option_context('display.max_colwidth', None):
        print(mystring)

order_of_cols = ["run_number","year","label"]
for hist in hists:
    for ender in enders:
        col_names = hist + ender
        order_of_cols.append(col_names)

for filepath in filepaths:
    df1 = pd.read_csv(filepath+filenames[0])
    df2 = pd.read_csv(filepath+filenames[1])
    df3 = pd.read_csv(filepath+filenames[2])

    merged_df = df1.merge(df2, on=["run_number","year","label"]).merge(df3, on=["run_number","year","label"])
    merged_df = merged_df[order_of_cols]

    merged_df.to_csv(filepath+'HLTPhysics_PCA_080724_CombResults.csv', index=False)
